## 核心设计原则

1. **业务驱动**：按业务领域而非技术功能拆分服务
2. **适度拆分**：避免过度微服务化，减少运维复杂度
3. **数据一致性**：优先考虑数据一致性而非最终一致性
4. **开发效率**：平衡开发效率和系统复杂度
5. **可演进性**：支持后续功能扩展和重构

## 🏗️ 最佳架构设计

### 1. **mms-common** - 通用配置，不提供服务
```
mms-common-bc/                 # 公共模块父项目
├── pom.xml                         # 父模块POM文件，管理所有子模块和公共依赖
├── README.md                       # 项目说明文档
├── mms-common-bc-core/                    # 核心基础模块（最常用）
│   ├── pom.xml                    # 核心模块依赖配置
│   └── src/main/java/com/yourcompany/common/core/
│       ├── annotation/            # 自定义注解目录
│       │   ├── Log.java           # 记录操作日志的切面注解[6](@ref)
│       │   └── RateLimit.java     # 接口限流注解
│       ├── constant/              # 常量定义目录
│       │   ├── CommonConstants.java # 全局通用常量（如字符编码、数字常量）
│       │   └── ErrorCode.java     # 统一错误码定义（如SUCCESS=200, FAIL=500）[7](@ref)
│       ├── enums/                 # 枚举类目录
│       │   ├── ResponseCode.java  # 统一响应状态码枚举（SUCCESS/FAIL等）[5](@ref)
│       │   └── StatusEnum.java    # 通用状态枚举（如ENABLE/DISABLE）
│       ├── exception/             # 异常处理目录
│       │   ├── BusinessException.java # 业务异常基类（继承RuntimeException）[6,7](@ref)
│       │   └── GlobalExceptionHandler.java # 全局异常处理器（统一异常响应）[4](@ref)
│       ├── result/                # 统一返回结果目录
│       │   ├── Result.java        # 统一响应体封装（code/message/data）[6,7](@ref)
│       │   └── PageResult.java    # 分页查询结果封装（增加total/pageSize等字段）
│       └── util/                  # 核心工具类目录
│           ├── DateUtil.java      # 日期时间处理工具类[6](@ref)
│           ├── StringUtil.java    # 字符串处理工具类（判空、格式化等）
│           └── JsonUtil.java     # JSON序列化/反序列化工具类[5,6](@ref)
├── mms-common-bc-web/                     # Web相关模块
│   ├── pom.xml                    # Web模块依赖配置
│   └── src/main/java/com/yourcompany/common/web/
│       ├── config/                # Web配置目录
│       │   ├── WebMvcConfig.java # MVC配置（拦截器、消息转换器等）[7](@ref)
│       │   └── CorsConfig.java   # 跨域资源配置（允许前端跨域访问）
│       ├── filter/               # 过滤器目录
│       │   └── RequestLogFilter.java # 请求日志过滤器（记录请求/响应信息）
│       └── interceptor/          # 拦截器目录
│           └── LogInterceptor.java # 日志拦截器（记录Controller方法执行时间）
└── mms-common-bc-database/              # 数据库相关模块
    ├── pom.xml                   # 数据库模块依赖配置（MyBatis-Plus等）
    └── src/main/java/com/yourcompany/common/database/
        ├── config/               # 数据库配置目录
        │   └── DataSourceConfig.java # 数据源配置（Druid连接池等）[4](@ref)
        └── base/                 # 基础类目录
            ├── BaseEntity.java   # 基础实体类（包含id/createTime/updateTime等字段）
            └── BaseMapper.java   # MyBatis-Plus基础Mapper接口（封装CRUD方法）[4](@ref)
```

**功能**：
- 统一异常处理
- 参数验证
- 安全认证（JWT、OAuth2）
- 配置管理
- 公共工具类

### 2. **mms-usercenter** - 用户管理服务
```
mms-user/
├── mms-usercenter-common/           # 用户相关实体、DTO
├── mms-usercenter-service/          # 用户业务逻辑
├── mms-usercenter-controller/       # 用户API接口
├── mms-usercenter-feign-api/        # 用户服务Feign接口
└── mms-usercenter-server/           # 用户服务启动类
```

**功能**：
- 用户管理（CRUD）
- 用户认证（登录、登出、刷新Token）
- 用户权限验证
- 用户状态管理
- 密码管理
- 用户画像

### 3. **mms-organization** - 组织权限服务
```
mms-organization/
├── mms-org-common/            # 组织相关实体
├── mms-org-service/           # 组织业务逻辑
├── mms-org-controller/        # 组织API接口
├── mms-org-feign-api/         # 组织服务Feign接口
└── mms-org-server/            # 组织服务启动类
```

**功能**：
- 组织架构管理（部门、岗位）
- 角色管理
- 权限管理（菜单权限、数据权限、按钮权限）
- 用户组织关系
- 权限验证
- 数据权限过滤

### 4. **mms-base - 基础数据服务
```
mms-system/
├── mms-base-common/         # 系统相关实体
├── mms-base-service/        # 系统业务逻辑
├── mms-base-controller/     # 系统API接口
├── mms-base-feign-api/      # 系统服务Feign接口
└── mms-base-server/         # 系统服务启动类
```

**功能**：
- 系统配置管理
- 字典管理
- 参数配置
- 菜单管理
- 系统监控
- 系统维护
- 数据字典

### 5. **mms-workflow** - 工作流服务
```
mms-workflow/
├── mms-workflow-common/       # 工作流相关实体
├── mms-workflow-service/      # 工作流业务逻辑
├── mms-workflow-controller/   # 工作流API接口
├── mms-workflow-feign-api/    # 工作流服务Feign接口
└── mms-workflow-server/       # 工作流服务启动类
```

**功能**：
- 流程定义管理
- 流程实例管理
- 任务管理
- 流程监控
- 流程统计
- 流程审批

### 6. **mms-notification** - 通知服务
```
mms-notification/
├── mms-notification-common/     # 通知相关实体
├── mms-notification-service/    # 通知业务逻辑
├── mms-notification-controller/ # 通知API接口
├── mms-notification-feign-api/  # 通知服务Feign接口
└── mms-notification-server/     # 通知服务启动类
```

**功能**：
- 站内消息
- 邮件通知
- 短信通知
- 推送通知
- 消息模板
- 通知历史

### 7. **mms-file** - 文件服务
```
mms-file/
├── mms-file-common/           # 文件相关实体
├── mms-file-service/          # 文件业务逻辑
├── mms-file-controller/       # 文件API接口
├── mms-file-feign-api/        # 文件服务Feign接口
└── mms-file-server/           # 文件服务启动类
```

**功能**：
- 文件上传下载
- 文件存储管理
- 文件预览
- 文件权限控制
- 文件版本管理
- 文件清理

### 8. **mms-log** - 日志审计服务
```
mms-log/
├── mms-log-common/            # 日志相关实体
├── mms-log-service/           # 日志业务逻辑
├── mms-log-controller/        # 日志API接口
├── mms-log-feign-api/         # 日志服务Feign接口
└── mms-log-server/            # 日志服务启动类
```

**功能**：
- 操作日志记录
- 系统日志收集
- 审计日志
- 日志查询分析
- 日志统计报表
- 日志归档

### 9. **mms-gateway** - API网关服务
```
mms-gateway/
└── mms-gateway-server/        # 网关服务启动类
```

**功能**：
- API路由转发
- 统一鉴权
- 限流熔断
- 请求日志
- 跨域处理
- 负载均衡

### 10. **mms-monitor** - 监控服务
```
mms-monitor/
├── mms-monitor-common/        # 监控相关实体
├── mms-monitor-service/       # 监控业务逻辑
├── mms-monitor-controller/    # 监控API接口
├── mms-monitor-feign-api/     # 监控服务Feign接口
└── mms-monitor-server/        # 监控服务启动类
```

**功能**：
- 系统性能监控
- 服务健康检查
- 资源监控
- 告警管理
- 监控大盘
- 性能分析

## 🎨 架构图

让我用文本方式描述架构图：

```
┌──────────────────────────────────────────────────────────────────┐
│                        前端应用层                                 │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ │
│  │   Web管理端  │ │   移动端     │ │   第三方     │ │   开放API   │ │
│  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ │
└─────────────────────────────────────────────────────────────────┘
                                │
┌──────────────────────────────────────────────────────────────────┐
│                        API网关层                                  │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │                    mms-gateway                              │ │
│  │  • 路由转发  • 统一鉴权  • 限流熔断  • 请求日志                  │ │
│  └─────────────────────────────────────────────────────────────┘ │
└──────────────────────────────────────────────────────────────────┘
                                │
┌──────────────────────────────────────────────────────────────────┐
│                        微服务层                                   │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ │
│  │mms-usercenter││mms-organization│ mms-base   │ │mms-workflow │ │
│  │  用户管理    │ │  组织权限    │ │  系统管理    │ │  工作流      │ │
│  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ │
│  │mms-notification│ mms-file   │ │   mms-log   │ │ mms-monitor │ │
│  │   通知服务   │ │  文件管理    │ │  日志审计    │ │   监控       │ │
│  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ │
└──────────────────────────────────────────────────────────────────┘
                                │
┌──────────────────────────────────────────────────────────────────┐
│                        基础配置                                   │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │                    mms-common                               │ │
│  │  • 公共组件  • 配置管理  • 安全认证  • 工具类                   │ │
│  └─────────────────────────────────────────────────────────────┘ │
└──────────────────────────────────────────────────────────────────┘
                                │
┌──────────────────────────────────────────────────────────────────┐
│                        数据存储层                                 │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ │
│  │   MySQL     │ │    Redis    │ │   MongoDB   │ │  文件存储    │ │
│  │  主数据库    │ │   缓存       │ │  日志存储    │ │  (MinIO)    │ │
│  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ │
└──────────────────────────────────────────────────────────────────┘
```

## 🔧 技术栈选择

### 后端技术栈
- **框架**：Spring Boot 3.2.4 + Spring Cloud 2023.0.1
- 配置与服务发现：nacos 2.3.2
- **数据库**：MySQL 8.0 + MyBatis Plus
- **缓存**：Redis 6.x
- **消息队列**：RocketMQ
- **文件存储**：MinIO
- **监控**：Prometheus + Grafana
- **日志**：ELK Stack (Elasticsearch + Logstash + Kibana)
- 接口文档：Swagger

### 前端技术栈
- **框架**：Vue 3 + TypeScript
- **UI库**：Element Plus
- **状态管理**：Pinia
- **路由**：Vue Router
- **构建工具**：Vite

## 🎯 架构优势

### 1. **合理的服务拆分**
- 按业务领域拆分，避免过度微服务化
- 每个服务职责清晰，便于维护
- 减少服务间通信复杂度

### 2. **统一的基础设施**
- 核心服务提供统一的公共能力
- 减少重复代码，提高开发效率
- 统一的技术栈和规范

### 3. **良好的扩展性**
- 支持水平扩展
- 支持功能模块扩展
- 支持多租户架构

### 4. **完善的监控体系**
- 全链路监控
- 性能监控
- 业务监控
- 告警机制

## 📋 实施流程

### 阶段一：基础服务（1-2个月）
1. 搭建 `mms-common` 通用配置
2. 实现 `mms-usercenter` 用户管理服务
3. 实现 `mms-gateway` API网关
4. 搭建基础监控体系

### 阶段二：核心功能（2-3个月）
1. 实现 `mms-organization` 组织权限服务
2. 实现 `mms-base` 系统管理服务
3. 实现 `mms-file` 文件服务
4. 完善前端管理界面

### 阶段三：高级功能（2-3个月）
1. 实现 `mms-workflow` 工作流服务
2. 实现 `mms-notification` 通知服务
3. 实现 `mms-log` 日志审计服务
4. 完善监控和运维体系

### 阶段四：优化完善（1-2个月）
1. 性能优化
2. 安全加固
3. 文档完善
4. 部署自动化

这个架构既保持了微服务的优势，又避免了过度复杂化，是一个平衡了开发效率、维护成本和系统复杂度的最佳方案。


## 数据库设计
![[Pasted image 20251022090724.png]]
